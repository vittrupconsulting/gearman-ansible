---

- name: "Debian package update"
  ansible.builtin.apt:
    update_cache: yes
  when: ansible_distribution == "Debian"

- name: "Debian gearman package"
  ansible.builtin.apt:
    name: "gearman-tools"
  when: ansible_distribution == "Debian"

- name: "Ubuntu package update"
  ansible.builtin.apt:
    update_cache: yes
  when: ansible_distribution == "Ubuntu"

- name: "Ubuntu gearman package"
  ansible.builtin.apt:
    name: "gearman-tools"
  when: ansible_distribution == "Ubuntu"

- name: "AlmaLinux epel package"
  ansible.builtin.dnf:
    name: "epel-release"
  when: ansible_distribution == "AlmaLinux"

- name: "AlmaLinux gearmand package"
  ansible.builtin.dnf:
    name: "gearmand"
  when: ansible_distribution == "AlmaLinux"

- name: "Rocky epel package"
  ansible.builtin.dnf:
    name: "epel-release"
  when: ansible_distribution == "Rocky"

- name: "Rocky gearmand package"
  ansible.builtin.dnf:
    name: "gearmand"
  when: ansible_distribution == "Rocky"

- name: "CentOS7 epel package"
  ansible.builtin.yum:
    name: "epel-release"
  when:
    - ansible_distribution == "CentOS"
    - ansible_distribution_major_version == "7"

- name: "CentOS7 gearmand package"
  ansible.builtin.yum:
    name: "gearmand"
  when:
    - ansible_distribution == "CentOS"
    - ansible_distribution_major_version == "7"

- ansible.builtin.template:
    src: "gearman.py.j2"
    dest: "/usr/local/sbin/gearman.py"